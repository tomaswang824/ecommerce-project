# 🔧 修复 Vercel 白屏问题

## 🎯 快速诊断

### 打开浏览器控制台查看错误

1. 访问你的 Vercel 网站
2. 按 **F12** 打开开发者工具
3. 切换到 **Console** 标签
4. 刷新页面
5. 查看红色错误信息

---

## 🔍 常见错误和解决方案

### 错误 1: API 连接失败 ⭐ 最常见

**Console 显示**：
```
Failed to load resource: net::ERR_CONNECTION_REFUSED
http://localhost:5000/api/products
```

**原因**：前端尝试连接本地后端 API，但 Vercel 上没有后端服务器。

**解决方案 A：使用模拟 API（快速测试）**

1. Vercel Dashboard → 项目 → Settings → Environment Variables
2. 添加：
   ```
   Name: VITE_API_URL
   Value: https://fakestoreapi.com
   ```
3. Redeploy

**解决方案 B：部署后端到云服务**

后端需要部署到：
- Railway (推荐) - https://railway.app
- Render - https://render.com
- Heroku
- 或你自己的服务器

部署后端后，在 Vercel 设置：
```
VITE_API_URL = https://你的后端地址.com
```

---

### 错误 2: 环境变量未生效

**症状**：
```
Uncaught TypeError: Cannot read properties of undefined
```

**原因**：环境变量配置错误或未重新部署。

**解决方案**：

1. 确保环境变量名以 `VITE_` 开头
2. 添加环境变量后必须 **Redeploy**
3. 不能只是重新访问页面

---

### 错误 3: 路由 404

**症状**：刷新页面或直接访问子路由显示 404

**原因**：SPA 路由配置问题

**解决方案**：

确认 `frontend/vercel.json` 包含：
```json
{
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```

如果没有，添加后重新推送到 GitHub。

---

### 错误 4: CORS 跨域问题

**Console 显示**：
```
Access to fetch at 'xxx' from origin 'xxx' has been blocked by CORS policy
```

**原因**：后端 API 未允许 Vercel 域名访问。

**解决方案**：

在后端 `server.js` 中配置 CORS：
```javascript
app.use(cors({
  origin: [
    'http://localhost:3000',
    'https://你的vercel域名.vercel.app'
  ]
}))
```

---

## 🛠️ 完整修复步骤

### 步骤 1: 检查错误类型

打开 Console，确定是哪种错误。

### 步骤 2: 配置环境变量

**临时测试**（使用模拟 API）：

Vercel → Settings → Environment Variables → Add
```
VITE_API_URL = https://fakestoreapi.com
```

**生产环境**（部署真实后端）：
```
VITE_API_URL = https://你的后端地址.com
```

### 步骤 3: 重新部署

Deployments → 最新部署 → Redeploy

### 步骤 4: 测试

访问网站，查看是否正常显示。

---

## 📋 环境变量配置参考

### 开发环境（无后端）

```bash
VITE_API_URL =
VITE_APP_TITLE = 电商平台
VITE_DEBUG = true
```

### 测试环境（模拟 API）

```bash
VITE_API_URL = https://fakestoreapi.com
VITE_APP_TITLE = 电商平台 [测试]
VITE_DEBUG = false
```

### 生产环境（真实后端）

```bash
VITE_API_URL = https://api.yourdomain.com
VITE_APP_TITLE = 电商平台
VITE_DEBUG = false
VITE_NODE_ENV = production
```

---

## 🔧 调试技巧

### 1. 查看 Network 请求

1. 开发者工具 → **Network** 标签
2. 刷新页面
3. 查看失败的请求（红色）
4. 点击查看详情

### 2. 查看 Sources

1. 开发者工具 → **Sources** 标签
2. 找到 `main.tsx` 或 `App.tsx`
3. 设置断点调试

### 3. 查看部署日志

1. Vercel Dashboard → Deployments
2. 点击部署记录
3. 查看 **Building** 日志
4. 确认构建成功

---

## 🚀 快速行动方案

### 立即执行（1分钟）：

1. **打开 Console** - 查看具体错误
2. **截图错误信息** - 发给我
3. **暂时配置测试 API**：
   ```
   VITE_API_URL = https://fakestoreapi.com
   ```
4. **Redeploy**

### 长期方案：

1. **部署后端 API**
   - 推荐使用 Railway
   - 免费且简单

2. **配置生产环境变量**
   ```
   VITE_API_URL = 你的后端地址
   ```

3. **更新 CORS 配置**
   - 允许 Vercel 域名访问

---

## 💡 提示

- 环境变量修改后**必须 Redeploy**
- 不要在代码中硬编码 API 地址
- 使用 `import.meta.env.VITE_API_URL`
- Console 错误信息很重要！

---

**现在打开 Console 查看错误，然后告诉我具体错误信息！** 🔍
